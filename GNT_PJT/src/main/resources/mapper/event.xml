<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="ns.sql.EventMapper">

	<!-- 퀴즈를 오늘 풀었나 안 풀었나 확인 -->
	<select id="selectQuizCK" parameterType="string" resultType="string">
		SELECT is_quiz_participate
		FROM users
		WHERE user_id=#{value}
	</select>
	
	<!-- 퀴즈 번호에 맞는 퀴즈 데이터 가져오기 :: 첫번째, quiz_id부터 가져오기 + 퀴즈 풀이 이후 :: 퀴즈 정답 가져오기 1(사용자->퀴즈 번호) -->
	<select id="selectQuizId" parameterType="string" resultType="string">
		SELECT quiz_id
		FROM users
		WHERE user_id=#{value}
	</select>
	
	<!-- 퀴즈 번호에 맞는 퀴즈 데이터 가져오기 :: 두번째, quiz select 하기 -->
	<select id="selectQuiz" parameterType="string" resultType="quiz"> <!-- error check :: select 절에 몇 개만 뽑아서 vo에 그대로 넣을 수 있나? -->
		SELECT quiz_content, select1, select2, select3, select4
		FROM quiz
		WHERE quiz_id=#{value}
	</select>
	





	<!-- 퀴즈 풀이 이후 :: 퀴즈 정답 가져오기 2(퀴즈 번호->퀴즈 정답) -->
	<select id="selectQuizAnswer" parameterType="string" resultType="int">
		SELECT answer
		FROM quiz
		WHERE quiz_id=#{value}
	</select>
	
	<!-- 퀴즈 풀이 이후 :: 퀴즈 여부 변경+퀴즈 번호 증가-->
	<update id="updateQuizUser" parameterType="string">
		UPDATE users
		SET is_quiz_participate='1' AND quiz_id = quiz_id+1
		WHERE user_id=#{value}
	</update>
		
	<!-- <update id="updateQuidId" parameterType="string">
		UPDATE users
		SET quiz_id = quiz_id + 1
		WHERE user_id = #{value}
	</update> -->
	
	
	
	
	
	<!-- 퀴즈 리셋 -->
	<update id="updateQuizReset">
		UPDATE users
		SET is_quiz_participate='0'
	</update>
	
	<!-- 돌림판 리셋(을 위한 user_id 가져오기) -->
	<select id="selectAllUserId" resultType="int">
		SELECT user_id
		FROM users
		WHERE user_id not in(1, 2, 3, 4) <!-- error check -->
	</select>
	
	
	
	
	
</mapper>